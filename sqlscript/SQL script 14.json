{
	"name": "SQL script 14",
	"properties": {
		"content": {
			"query": "DROP VIEW [dbo].[Insurance_Data]\nGO\n\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[Insurance_Data]\nAS select \nROW_NUMBER() Over (Order by a.Customer_id) as R_No,\na.Customer_id, \nConcat(a.First_name, ' - ' , a.Last_name) as Customer_Name,\na.Address, \na.City,\na.State,\na.Zip_Code,\na.Phone_number,\na.Gender,\nb.Policy_id,\nb.Policy_status,\nDatediff(year,b.Policy_end_date,b.Policy_start_date) as Policy_Year,\nb.Policy_start_date,\nb.Policy_end_date,\nb.Premium_amount,\nb.payment_method,\nb.Payment_date,\nb.Policy_type\n--,\n --c.[Claim_id]\n--,c.[Claim_type]\n--,c.[Claim_amount]\n--,\n--cast(c.[Claim_amount] as int) - cast(b.Premium_Amount as int) as profitability,\n--case when (cast(c.[Claim_amount] as int) - cast(b.Premium_Amount as int)) >  0 then 'Non Profit' else 'Profit' end as [Column 2]\nfrom [dbo.].[Insurance_Customer] a \njoin [dbo.].[Insurance_Premium] b on a.Customer_ID = b.Customer_id\n--join [dbo.].[Insurance_Claims] c on a.Customer_id = c.[Customer_id] and b.Customer_id = c.[Customer_id];\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "synapsededicatedpool",
				"poolName": "synapsededicatedpool"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}